<!-- Made by Sebastian Lack -->
<!DOCTYPE html>
<html>
	<head>
		<meta charset='UTF-8'>
		<title>Project Grow</title>
		<link rel="icon" href="00_Pictures\icon.gif">
		<link rel="stylesheet" href="css\main.css">
		<link rel="stylesheet" href="css\alertify.bootstrap.css">
		<link rel="stylesheet" href="css\alertify.core.css">
		<link rel="stylesheet" href="css\alertify.default.css">
		 <script src="alertify.js"></script>
	</head>
	<body>
		<div class="container">
			<h1>Project Grow</h1>
			<canvas id='js-canvas' width="900" height="400" onclick="clicking()"></canvas>
			<script>
				var canvas = document.getElementById('js-canvas')
				var ctx = canvas.getContext('2d')
				var phase = 1
				var apples = 0
				var basecost = 10
				var uppart = 1
				var bonus = 0
				var cost = 6
				var clicks = 0
				var int = 0
				var scrolled = 0
				var achievement = 0
				
				//Makes a save if there's no data
				if(sessionStorage.getItem('saved') != 1){
						savedata()
						console.log('Finished auto-save')
				}

				//Function for making leafs
				function makeleaf(leafs, max1, min1, max2, min2, color){
					for(i = 0; i < leafs; i++){
						ctx.fillStyle = color
						randx = Math.floor(Math.random() * (max1-min1)+min1);
						randy = Math.floor(Math.random() * (max2-min2)+min2);
						size = Math.floor(Math.random() * (25-10)+10);
						ctx.fillRect ((250+randx), randy, size, size);
					}
				}

				function makeapple(apples, max1, min1, max2, min2){
						for(i = 0; i < apples; i++){
							//Generating random color for the apples
							nr1 = (Math.floor(Math.random() * (15-7)+7)).toString(16);
							nr2 = (Math.floor(Math.random() * (15-0))).toString(16);
							nr3 = (Math.floor(Math.random() * (7-0))).toString(16);
							var color = '#'+nr1+nr2+nr3+'000'

							ctx.fillStyle = color
							randx = Math.floor(Math.random() * (max1-min1)+min1);
							randy = Math.floor(Math.random() * (max2-min2)+min2);
							size = Math.floor(Math.random() * (25-10)+10);
							ctx.fillRect ((250+randx), randy, size, size);
					}
				}
				
				function clicking(){
					//Switch for changing Phases
					switch(phase){
						case 0: phase0()
						break;
						case 1: phase1()
						break;
						case 2: phase2()
						break;
						case 3: phase3()
						break;
						case 4: phase4()
						break;
						default: console.log("ERROR")
						console.log("Phase is:"+phase)
					}
					if(apples >= 100 && apples < 150){
							achievement = 1
							console.log('achievement 1')
					}else if(apples >= 150 && apples < 200){
							achievement = 2
							console.log('achievement 2')
					}else if(apples >= 200 && apples < 250){
							achievement = 3
							console.log('achievement 3')
					}else if(apples >= 250){
							achievement = 4
							console.log('achievement 4')
					}
					switch(achievement){
							case 1: alertify.log("<h3>Achievement get</h3><br> You are wasting your life");
							break;
							case 2: alertify.log("<h3>Achievement get</h3><br> You are REALLY wasting your time right now");
							break;
							case 3: alertify.log("<h3>Achievement get</h3><br> Aren't you listening to me, stop wasting your time");
							break;
							case 4: alertify.log("<h3>Screw it, I'm giving up, just do whatever you want");
							break;
							default:
					}
				}
				
				//Functions for the 5 phases
				function phase0(){
					ctx.clearRect(0, 0, canvas.width, canvas.height);
					phase++;
					apples += bonus + 1;
					amount.innerHTML = apples
					if(document.getElementById('autobox').checked){
							upgrade();
					}

					
				}
				function phase1(){
					phase++		
					ctx.fillStyle = '#813131'
					ctx.fillRect (440, 370, 20, 20)
				}
				function phase2(){
					phase++
					ctx.fillRect (430, 120, 40, 270)
				}
				function phase3(){
					phase++
					makeleaf(60, 270, 110, 180, 70, '#228b22')
				}
				function phase4(){
					phase = 0
					makeleaf(150, 320, 50, 250, 40, '#228b22')

					if(bonus+1 <= 100){
						makeapple(bonus+1, 300, 80, 220, 90)
					}else{
						makeapple(100, 300, 80, 220, 90)
					}
				}
				
				//Function for Upgrading
				function upgrade(){
					upbutton.innerHTML = "Upgrade"
					if(apples >= cost && uppart < 4){
						uppart++;
						apples -= cost;
					}
					
					if(uppart == 5){
						uppart = 1;
						bonus++;
					}
					
					cost = Math.floor((uppart * 0.75)*(bonus + 0.8)*basecost);
					amount.innerHTML = apples
					upgradepart.innerHTML = uppart
					upcost.innerHTML = cost+"&nbspapples"
					bonusapples.innerHTML = bonus
					
					
					if(uppart == 4){
						uppart++;
						upbutton.innerHTML = "Upgrade Ready"
						upcost.innerHTML = "Free upgrade, no apples"
					}
				}
				
				function savedata(){
					sessionStorage.setItem('phase', phase);
					sessionStorage.setItem('apples', apples);
					sessionStorage.setItem('basecost', basecost);
					sessionStorage.setItem('uppart', uppart);
					sessionStorage.setItem('bonus', bonus);
					sessionStorage.setItem('clicks', clicks);
					sessionStorage.setItem('saved', '1')
					
					console.log('saved')
				}
				
				function loaddata(){
					phase = 0
					apples = parseInt(sessionStorage.getItem('apples'));
					basecost = parseInt(sessionStorage.getItem('basecost'));
					uppart = parseInt(sessionStorage.getItem('uppart'));
					bonus = parseInt(sessionStorage.getItem('bonus'));
					cost = Math.floor((uppart * 0.75)*(bonus + 0.8)*basecost);
					clicks = parseInt(sessionStorage.getItem('clicks'));
					
					upgradepart.innerHTML = uppart
					upcost.innerHTML = cost+"&nbspapples"
					bonusapples.innerHTML = bonus
					clickamount.innerHTML = clicks
					amount.innerHTML = apples

					console.log('loaded')
				}
				
				function cheat(){
						alertify.prompt("How much apples do you want to add", function(empty, add){
								add = parseInt(add)
								if(isNaN(add)){
									add = 0
									console.log('its not a number')
								}else{
									apples += add;
								}
								amount.innerHTML = apples
						})
				}

				canvas.addEventListener('click', function () {
					clicks++;
					clickamount.innerHTML = clicks
				})
				
				document.addEventListener('keydown', function(event){
					if(event.keyCode >= 48 && event.keyCode <= 57 || event.keyCode >= 96 && event.keyCode <= 105){
							return;
					}
					//console.log(event.which)
					switch(event.keyCode){
							case 8: 	//nothing happens		//Backspace-Key
							case 13: 	//nothing happens		//Enter-Key
							case 116: //nothing happens		//F5-Key
							break;
							case 85: upgrade();						//U-Key
							break;
							case 67: cheat()							//C-Key
							break;
							default: clicking();
					}
				})

				document.addEventListener('DOMMouseScroll', function(test){
						clicking()
				})
			</script>
			<br>
			<div id="text">
				<p class="applenmbr">Number of apples: </p>
				<p id="amount" class="active applenmbr">0</p>
				<div class="noline">
					<p>Additional apple per Cycle:&nbsp <p id="bonusapples" class="active">0</p></p>
					<br>
					<p><button onclick="upgrade()" class="myButton2"><p id="upbutton" class="active">Upgrade</p>
					</button> Part&nbsp <p id="upgradepart" class="active">1</p> out of 4</p>
					<br>
					<p>Upgrade cost:&nbsp <p id="upcost" class="active">6 apples</p></p>
					<br>
					<p>Automatic Upgrading: <input type="checkbox" id="autobox"></p>
					<br>
					<p>Amount of Clicks: <p id="clickamount">0</p></p>
				</div>
				<button onclick="savedata()" class="myButton">Save Data</button>
				<button onclick="loaddata()" class="myButton">Load Data</button>
			</div>
		</div>
	</body>
</html>
